{% extends 'base.html' %}

{% block content %}
  {{ super() }}
  {% from 'args-table.html' import args_table with context %}
  {% from 'content-grid.html' import content_grid %}
  {% from 'metadata.html' import list_metadata %}

  <p>{{ model_description }}</p>
  <h2 class="section-header">Primary Outputs</h2>
  {{ accordion_section(
    'Coastal exposure and the protective role of habitats',
    content_grid([
      ('<div id="exposure_map"></div>', 50),
      ('<div id="habitat_map"></div>', 50),
      ('<div id="exposure_histogram"></div>', 50),
      ('<div>' + habitat_params_table + '<p>' + habitat_table_description + '</p></div>', 50)
    ])
  ) }}

  <h2 class="section-header">Intermediate Outputs</h2>
  {{ accordion_section(
    'Ranked exposure variables',
    '<div id="rank_vars_figure"></div>'|safe
  ) }}

  {{ accordion_section(
    'Pre-ranked variables',
    '<div id="intermediate_vars_histograms"></div>'|safe
  ) }}

  {{ accordion_section(
    'Wave Exposure',
    content_grid([
      ('<div id="wave_energy_map"></div>', 70),
      ('<p>
        Shore points are exposed to open ocean waves and local wind-driven waves.
        The model estimates the energy of both wave types at each point, and
        uses the larger value to represent wave energies at that point. Wind-driven
        waves tend to dominate in areas sheltered from the open ocean.
      </p>', 30)
    ])
  ) }}

  <h2 class="section-header">Inputs</h2>
  {{ accordion_section(
    'Arguments',
    args_table(),
  )}}

  <h2 class="section-header">Metadata</h2>
  {{
    accordion_section(
      'Output Filenames and Descriptions',
      list_metadata(model_spec_outputs)
    )
  }}

{% endblock content %}

{% from 'vegalite-plot.html' import embed_vega %}
{% block scripts %}
  {{ super() }}
  <script src="https://cdn.jsdelivr.net/npm/vega@5"></script>
  <script src="https://cdn.jsdelivr.net/npm/vega-lite@5.20.1"></script>
  <script src="https://cdn.jsdelivr.net/npm/vega-embed@6"></script>
  {% include 'vega-embed-js.html' %}
  {% set chart_spec_id_list = [
    (exposure_map_json, 'exposure_map'),
    (habitat_map_json, 'habitat_map'),
    (exposure_histogram_json, 'exposure_histogram')
  ] %}
  {{ embed_vega(chart_spec_id_list) }}
  {{ embed_vega([
    (rank_vars_figure_json, 'rank_vars_figure')
  ]) }}
  {{ embed_vega([
    (facetted_histograms_json, 'intermediate_vars_histograms')
  ]) }}
  {{ embed_vega([(wave_energy_map_json, 'wave_energy_map')]) }}
{% endblock scripts %}
